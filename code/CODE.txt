#include <LiquidCrystal.h>

//* How to use the DHT-11 sensor with Arduino
//   Temperature and humidity sensor and
//   I2C LCD1602
 //  SDA --> A4
 //  SCL --> A5

//Libraries
#include <DHT.h>
//I2C LCD:
#include <LiquidCrystal_I2C.h>
#include <Wire.h>

LiquidCrystal_I2C lcd(0x27,16,2); // set the LCD address to 0x27 for a 16 chars and 2 line display
  
//Constants
#define DHTPIN 7     // what pin we're connected to
#define DHTTYPE DHT11 // DHT 11
#define sensorPin A0
#define motor 6
DHT dht(DHTPIN, DHTTYPE);//// Initialize DHT sensor for normal 16mhz Arduino

//Variables
//int chk;
int h;  //Stores humidity value
int t; //Stores temperature value

void setup()
{
    Serial.begin(9600);
    dht.begin();
    pinMode(motor, OUTPUT);
    digitalWrite(motor, HIGH);
    lcd.init(); //initialize the lcd
    lcd.backlight(); //open the backlight
    lcd.clear();
    lcd.setCursor(0, 0);
    lcd.println("SmartIrrigation ");
    lcd.setCursor(0, 1);
    lcd.println("System");
    delay(5000);
}

void loop()
{
    int sensorValue = analogRead(sensorPin);
    //Read data and store it to variables h (humidity) and t (temperature)
    // Reading temperature or humidity takes about 250 milliseconds!
    h = dht.readHumidity();
    t = dht.readTemperature();

// set the cursor to (0,0):
// print from 0 to 9:
    lcd.clear();
    lcd.setCursor(0, 0);
    lcd.println("Temperature :");
    lcd.setCursor(13, 0);
    lcd.print(t);
    lcd.print("C");
    lcd.setCursor(0, 1);
    lcd.print("Humidity:");
    lcd.print(h);
    lcd.print("%");
    delay(2000); //Delay 1 sec.
    lcd.clear();
    lcd.setCursor(0, 0);
    lcd.print("Soil Moisture"); 
    lcd.print(sensorValue);
    lcd.setCursor(0, 1);
    if(sensorValue <= 500) // if water level is full then cut the relay 
    {
        digitalWrite(motor,LOW); // low is to cut the relay
        lcd.print("Motor off");
    }
    else
    {
        digitalWrite(motor,HIGH); //high to continue proving signal and water supply
        lcd.print("Motor on");
    }
    delay(2000); //Delay 2 sec.
}